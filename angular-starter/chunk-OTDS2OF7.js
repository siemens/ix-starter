import{b as w}from"./chunk-35Z3LQ2S.js";import{a as c,b as u,c as m,d as p,g,h as f}from"./chunk-CZHMCKIS.js";import{a as b}from"./chunk-WTXUZEV6.js";import{a as d,b as o}from"./chunk-3AB2V46W.js";import{a as h}from"./chunk-Y5IHOO62.js";import{a as v,d as a,e as y,f as E,g as k}from"./chunk-GG4ZXK7F.js";import{f as r}from"./chunk-S5EYVFES.js";var S=":host{background-color:var(--theme-color-2);border-radius:var(--theme-default-border-radius);min-width:0px;z-index:var(--theme-z-index-dropdown);box-shadow:var(--theme-shadow-4);padding:0.25rem 0px}:host *,:host *::after,:host *::before{box-sizing:border-box}:host ::-webkit-scrollbar-button{display:none}@-moz-document url-prefix(){:host *{scrollbar-color:var(--theme-scrollbar-thumb--background) var(--theme-scrollbar-track--background);scrollbar-width:thin}}:host{}:host ::-webkit-scrollbar{width:0.5rem;height:0.5rem}:host{}:host ::-webkit-scrollbar-track{border-radius:5px;background:var(--theme-scrollbar-track--background)}:host ::-webkit-scrollbar-track:hover{background:var(--theme-scrollbar-track--background--hover)}:host{}:host ::-webkit-scrollbar-thumb{border-radius:5px;background:var(--theme-scrollbar-thumb--background)}:host{}:host ::-webkit-scrollbar-thumb:hover{background:var(--theme-scrollbar-thumb--background--hover)}:host ::-webkit-scrollbar-corner{display:none}:host .dropdown-header{display:flex;align-items:center;height:2.5rem;color:var(--theme-menu-header--color);padding:0 1rem}:host(.overflow){max-height:calc(50vh - 3rem);overflow-y:auto}:host(:not(.show)){display:none}",x=0,U=(()=>{let l=class{constructor(e){v(this,e),this.showChanged=k(this,"showChanged",7),this.suppressAutomaticPlacement=!1,this.show=!1,this.closeBehavior="both",this.placement="bottom-start",this.positioningStrategy="fixed",this.discoverAllSubmenus=!1,this.ignoreRelatedSubmenu=!1,this.suppressOverflowBehavior=!1,this.localUId=`dropdown-${x++}`,this.assignedSubmenu=[],this.itemObserver=new MutationObserver(()=>{this.arrowFocusController&&(this.arrowFocusController.items=this.dropdownItems)})}connectedCallback(){o.connected(this),this.trigger!=null&&this.registerListener(this.trigger)}cacheSubmenuId(e){e.stopImmediatePropagation(),e.preventDefault();let{detail:t}=e;this.assignedSubmenu.indexOf(t)===-1&&this.assignedSubmenu.push(t)}disconnectedCallback(){var e;o.dismiss(this),o.disconnected(this),this.arrowFocusController&&((e=this.arrowFocusController)===null||e===void 0||e.disconnect(),this.arrowFocusController=void 0),this.itemObserver&&(this.itemObserver.disconnect(),this.itemObserver=void 0),this.disposeClickListener&&(this.disposeClickListener(),this.disposeClickListener=void 0),this.disposeKeyListener&&(this.disposeKeyListener(),this.disposeKeyListener=void 0),this.autoUpdateCleanup&&(this.autoUpdateCleanup(),this.autoUpdateCleanup=void 0)}getAssignedSubmenuIds(){return this.assignedSubmenu}isPresent(){return this.show}present(){this.show=!0}dismiss(){this.show=!1}getId(){return this.localUId}willDismiss(){let{defaultPrevented:e}=this.showChanged.emit(!1);return!e}willPresent(){let{defaultPrevented:e}=this.showChanged.emit(!0);return!e}get dropdownItems(){return Array.from(this.hostElement.querySelectorAll("ix-dropdown-item"))}get slotElement(){return this.hostElement.shadowRoot.querySelector("slot")}addEventListenersFor(){var e,t,i;(e=this.disposeClickListener)===null||e===void 0||e.call(this),(t=this.disposeKeyListener)===null||t===void 0||t.call(this);let s=()=>{this.isPresent()?o.dismiss(this):o.present(this),o.dismissOthers(this.getId())};this.triggerElement&&(this.disposeClickListener=h(this.triggerElement,"click",n=>{n.defaultPrevented||s()}),(i=this.triggerElement)===null||i===void 0||i.setAttribute("data-ix-dropdown-trigger",this.localUId))}discoverSubmenu(){return r(this,null,function*(){var e;(e=this.triggerElement)===null||e===void 0||e.dispatchEvent(new CustomEvent("ix-assign-sub-menu",{bubbles:!0,composed:!0,cancelable:!0,detail:this.localUId}))})}registerKeyListener(){this.triggerElement&&(this.disposeKeyListener=h(this.triggerElement,"keydown",e=>{e.key==="ArrowDown"&&document.activeElement===this.triggerElement&&(o.present(this),setTimeout(()=>{this.focusDropdownItem(0)}))}))}registerListener(e){return r(this,null,function*(){this.triggerElement=yield this.resolveElement(e),this.triggerElement&&(this.addEventListenersFor(),this.discoverSubmenu())})}resolveElement(e){return r(this,null,function*(){let t=yield w(e);return this.checkForSubmenuAnchor(t)})}checkForSubmenuAnchor(e){return r(this,null,function*(){if(e){if(d(e)){let t=yield e.getDropdownItemElement();t.isSubMenu=!0,this.hostElement.style.zIndex="var(--theme-z-index-dropdown)"}return e.tagName==="IX-DROPDOWN-ITEM"&&(e.isSubMenu=!0,this.hostElement.style.zIndex="var(--theme-z-index-dropdown)"),e}})}resolveAnchorElement(){return r(this,null,function*(){this.anchor?this.anchorElement=yield this.resolveElement(this.anchor):this.trigger&&(this.anchorElement=yield this.resolveElement(this.trigger))})}changedShow(e){return r(this,null,function*(){var t,i,s,n;e?(yield this.resolveAnchorElement(),this.anchorElement&&this.applyDropdownPosition(),this.arrowFocusController=new b(this.dropdownItems,this.hostElement,C=>this.focusDropdownItem(C)),(t=this.itemObserver)===null||t===void 0||t.observe(this.hostElement,{childList:!0,subtree:!0}),this.registerKeyListener()):(this.destroyAutoUpdate(),(i=this.arrowFocusController)===null||i===void 0||i.disconnect(),(s=this.itemObserver)===null||s===void 0||s.disconnect(),(n=this.disposeKeyListener)===null||n===void 0||n.call(this))})}changedTrigger(e){this.registerListener(e)}destroyAutoUpdate(){this.autoUpdateCleanup&&(this.autoUpdateCleanup(),this.autoUpdateCleanup=void 0)}isAnchorSubmenu(){var e;return d(this.anchorElement)?!0:!!(!((e=this.anchorElement)===null||e===void 0)&&e.closest("ix-dropdown-item"))}applyDropdownPosition(){return r(this,null,function*(){var e,t;if(!this.show||!this.anchorElement)return;let i=this.isAnchorSubmenu(),s={strategy:this.positioningStrategy,middleware:[]};this.suppressAutomaticPlacement||(e=s.middleware)===null||e===void 0||e.push(p({fallbackStrategy:"initialPlacement"})),s.placement=i?"right-start":this.placement,s.middleware=[...((t=s.middleware)===null||t===void 0?void 0:t.filter(Boolean))||[],g(),m()],this.offset&&s.middleware.push(u(this.offset)),this.destroyAutoUpdate(),this.anchorElement&&(this.autoUpdateCleanup=c(this.anchorElement,this.hostElement,()=>r(this,null,function*(){if(this.anchorElement){let n=yield f(this.anchorElement,this.hostElement,s);Object.assign(this.hostElement.style,{top:"0",left:"0",transform:`translate(${Math.round(n.x)}px,${Math.round(n.y)}px)`})}if(this.overwriteDropdownStyle){let n=yield this.overwriteDropdownStyle({dropdownRef:this.hostElement,triggerRef:this.triggerElement});Object.assign(this.hostElement.style,n)}}),{ancestorResize:!0,ancestorScroll:!0,elementResize:!0}))})}focusDropdownItem(e){requestAnimationFrame(()=>{var t,i;let s=(i=(t=this.dropdownItems[e])===null||t===void 0?void 0:t.shadowRoot)===null||i===void 0?void 0:i.querySelector("button");s&&s.focus()})}componentDidLoad(){return r(this,null,function*(){this.trigger&&this.changedTrigger(this.trigger)})}componentDidRender(){return r(this,null,function*(){yield this.applyDropdownPosition(),yield this.resolveAnchorElement()})}isTriggerElement(e){return!!e.hasAttribute("data-ix-dropdown-trigger")}onDropdownClick(e){let t=o.pathIncludesTrigger(e.composedPath());if(t&&(t!==this.triggerElement&&e.preventDefault(),this.isTriggerElement(t))){this.closeBehavior==="outside"&&e.preventDefault();return}if(!e.defaultPrevented&&(this.closeBehavior==="inside"||this.closeBehavior==="both")){o.dismissAll([this.getId()],this.ignoreRelatedSubmenu);return}o.dismissOthers(this.getId())}updatePosition(){return r(this,null,function*(){this.applyDropdownPosition()})}render(){return a(y,{key:"86e8b81af4bc5ad0fe27bbe62e9f1f7eb7c49f7e","data-ix-dropdown":this.localUId,class:{"dropdown-menu":!0,show:this.show,overflow:!this.suppressOverflowBehavior},style:{margin:"0",minWidth:"0px",position:this.positioningStrategy},role:"list",onClick:e=>this.onDropdownClick(e)},a("div",{key:"071d50d4dd055be7a6d430cf913de9e6a99ca88b",style:{display:"contents"}},this.header&&a("div",{key:"408ab95eb7afaa61e1752204ebc1435038ecf49d",class:"dropdown-header"},this.header),this.show&&a("slot",{key:"3945c3c05e90a93acaaaff3110a26485fe058324"})))}get hostElement(){return E(this)}static get watchers(){return{show:["changedShow"],trigger:["changedTrigger"]}}};return l.style=S,l})();export{U as ix_dropdown};
