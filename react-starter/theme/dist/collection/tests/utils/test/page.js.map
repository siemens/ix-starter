{"version":3,"file":"page.js","sourceRoot":"","sources":["../../../../src/tests/utils/test/page.ts"],"names":[],"mappings":"AAAA;;;;;;;GAOG;AACH,OAAO,EAIL,IAAI,IAAI,QAAQ,GAEjB,MAAM,kBAAkB,CAAC;AAE1B,KAAK,UAAU,iBAAiB,CAAC,IAAU,EAAE,QAAkB;;IAC7D,MAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1C,MAAM,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACrD,MAAM,KAAK,GAAG,MAAA,MAAA,QAAQ,CAAC,OAAO,CAAC,QAAQ,0CAAE,KAAK,mCAAI,oBAAoB,CAAC;IACvE,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC;QACxB,IAAI,EAAE,KAAK;KACZ,CAAC,CAAC;IACH,IAAI,CAAC,IAAI,GAAG,KAAK,EAAE,GAAW,EAAE,OAAO,EAAE,EAAE;QACzC,MAAM,QAAQ,GAAG,MAAM,YAAY,CACjC,mCAAmC,GAAG,UAAU,KAAK,EAAE,EACvD,OAAO,CACR,CAAC;QAEF,MAAM,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QAChC,OAAO,QAAQ,CAAC;IAClB,CAAC,CAAC;IAEF,IAAI,CAAC,UAAU,GAAG,KAAK,EAAE,OAA+B,EAAE,EAAE;QAC1D,MAAM,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;QAC/B,OAAO,iBAAiB,CAAC,OAAO,CAAC,CAAC;IACpC,CAAC,CAAC;IAEF,OAAO,IAAI,CAAC;AACd,CAAC;AAED,MAAM,CAAC,MAAM,cAAc,GAAG,QAAQ,CAAC,MAAM,CAAC;IAC5C,IAAI,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,EAAE,QAAQ,EAAE,EAAE;QACtC,IAAI,GAAG,MAAM,iBAAiB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAC/C,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC;IAClB,CAAC;CACF,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,IAAI,GAAG,QAAQ,CAAC,MAAM,CAMhC;IACD,aAAa,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,EAAE,EAAE;QACrC,GAAG,CAAC,CAAC,QAAQ,EAAE,QAAQ,EAAE,EAAE,CACzB,IAAI,CAAC,cAAc,CACjB,KAAK,EAAE,EAAE,QAAQ,EAAE,QAAQ,EAAE,EAAE,EAAE;YAC/B,MAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAE7C,IAAI,QAAQ,EAAE,CAAC;gBACb,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YAC5B,CAAC;YAED,OAAO,GAAG,CAAC;QACb,CAAC,EACD;YACE,QAAQ;YACR,QAAQ;SACT,CACF,CACF,CAAC;IACJ,CAAC;IACD,KAAK,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,EAAE,QAAQ,EAAE,EAAE;;QACvC,MAAM,KAAK,GAAG,MAAA,MAAA,QAAQ,CAAC,OAAO,CAAC,QAAQ,0CAAE,KAAK,mCAAI,oBAAoB,CAAC;QACvE,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC;YACxB,IAAI,EAAE,KAAK;SACZ,CAAC,CAAC;QACH,MAAM,IAAI,CAAC,IAAI,CACb,6DAA6D,KAAK,EAAE,CACrE,CAAC;QACF,GAAG,CAAC,CAAC,QAAQ,EAAE,EAAE;YACf,OAAO,IAAI,CAAC,cAAc,CACxB,KAAK,EAAE,EAAE,iBAAiB,EAAE,EAAE,EAAE;gBAC9B,MAAM,MAAM,CAAC,cAAc,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;gBACrD,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;gBAC/C,KAAK,CAAC,SAAS,GAAG,iBAAiB,CAAC;gBACpC,OAAO,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAgB,CAAC;YAC/C,CAAC,EACD,EAAE,iBAAiB,EAAE,QAAQ,EAAE,CAChC,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC;CACF,CAAC,CAAC","sourcesContent":["/*\n * SPDX-FileCopyrightText: 2024 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport {\n  ElementHandle,\n  Page,\n  PageScreenshotOptions,\n  test as testBase,\n  TestInfo,\n} from '@playwright/test';\n\nasync function extendPageFixture(page: Page, testInfo: TestInfo) {\n  const originalGoto = page.goto.bind(page);\n  const originalSceenshot = page.screenshot.bind(page);\n  const theme = testInfo.project.metadata?.theme ?? 'theme-classic-dark';\n  testInfo.annotations.push({\n    type: theme,\n  });\n  page.goto = async (url: string, options) => {\n    const response = await originalGoto(\n      `http://127.0.0.1:8080/src/tests/${url}?theme=${theme}`,\n      options\n    );\n\n    await page.waitForTimeout(1000);\n    return response;\n  };\n\n  page.screenshot = async (options?: PageScreenshotOptions) => {\n    await page.waitForTimeout(150);\n    return originalSceenshot(options);\n  };\n\n  return page;\n}\n\nexport const regressionTest = testBase.extend({\n  page: async ({ page }, use, testInfo) => {\n    page = await extendPageFixture(page, testInfo);\n    await use(page);\n  },\n});\n\nexport const test = testBase.extend<{\n  mount: (selector: string) => Promise<ElementHandle<HTMLElement>>;\n  createElement: (\n    selector: string,\n    appendTo?: ElementHandle<Element>\n  ) => Promise<ElementHandle<HTMLElement>>;\n}>({\n  createElement: async ({ page }, use) => {\n    use((selector, appendTo) =>\n      page.evaluateHandle(\n        async ({ selector, appendTo }) => {\n          const elm = document.createElement(selector);\n\n          if (appendTo) {\n            appendTo.appendChild(elm);\n          }\n\n          return elm;\n        },\n        {\n          selector,\n          appendTo,\n        }\n      )\n    );\n  },\n  mount: async ({ page }, use, testInfo) => {\n    const theme = testInfo.project.metadata?.theme ?? 'theme-classic-dark';\n    testInfo.annotations.push({\n      type: theme,\n    });\n    await page.goto(\n      `http://127.0.0.1:8080/src/tests/utils/ct/index.html?theme=${theme}`\n    );\n    use((selector) => {\n      return page.evaluateHandle(\n        async ({ componentSelector }) => {\n          await window.customElements.whenDefined('ix-button');\n          const mount = document.querySelector('#mount');\n          mount.innerHTML = componentSelector;\n          return mount.children.item(0) as HTMLElement;\n        },\n        { componentSelector: selector }\n      );\n    });\n  },\n});\n"]}